<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.4" DspName="Microsoft.Data.Tools.Schema.Sql.Sql100DatabaseSchemaProvider" CollationLcid="1033" CollationCaseSensitive="False" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="False" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="False" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="100" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="PARM_Control.dll" />
			<Metadata Name="FileName" Value="C:\USERS\NVRMND\BITTORRENT SYNC\SYNC\BARKING_CAT\PARM\PARM\PARM_CONTROL\OBJ\DEBUG\PARM_CONTROL.DLL" />
			<Metadata Name="AssemblyName" Value="PARM_Control" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" Value="C:\Users\nvrmnd\BitTorrent Sync\Sync\Barking_Cat\PARM\PARM\PARM_Control\obj\Debug\PARM_Control.pdb" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions" Disambiguator="1">
			<Property Name="Collation" Value="Latin1_General_CI_AS" />
			<Property Name="IsAnsiPaddingOn" Value="False" />
			<Property Name="IsQuotedIdentifierOn" Value="False" />
			<Property Name="IsCursorDefaultScopeGlobal" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="RecoveryMode" Value="1" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Control].[UploadQueue].[StatusCode]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="6" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Control].[UploadQueue].[QueueDate]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="7" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Control].[DownloadQueue].[StatusCode]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="8" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Control].[DownloadQueue].[QueueDate]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="9" />
		</Element>
		<Element Type="SqlForeignKeyConstraint">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Control].[UploadQueue].[FileID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Control].[Files].[FileID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Control].[Files]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="10" />
		</Element>
		<Element Type="SqlForeignKeyConstraint">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Control].[UploadQueue].[RunID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Control].[Run].[RunID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="11" />
		</Element>
		<Element Type="SqlForeignKeyConstraint">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Control].[UploadQueue].[StatusCode]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Control].[QueueStatusCodes].[StatusCode]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Control].[QueueStatusCodes]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="12" />
		</Element>
		<Element Type="SqlForeignKeyConstraint">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Control].[DownloadQueue].[FileID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Control].[Files].[FileID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Control].[Files]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="13" />
		</Element>
		<Element Type="SqlForeignKeyConstraint">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Control].[DownloadQueue].[RunID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Control].[Run].[RunID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="14" />
		</Element>
		<Element Type="SqlForeignKeyConstraint">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Control].[DownloadQueue].[StatusCode]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Control].[QueueStatusCodes].[StatusCode]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Control].[QueueStatusCodes]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="15" />
		</Element>
		<Element Type="SqlForeignKeyConstraint">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Control].[Files].[SystemID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[Files]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Control].[SourceSystems].[SystemID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Control].[SourceSystems]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="16" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Control].[SourceSystems].[SystemID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[SourceSystems]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="17" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Control].[UploadQueue].[UploadQueueID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="18" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Control].[DownloadQueue].[DownloadQueueID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="19" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Control].[Files].[FileID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[Files]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="20" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Control].[Run].[RunID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="21" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Control].[QueueStatusCodes].[StatusCode]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[QueueStatusCodes]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="22" />
		</Element>
		<Element Type="SqlRoleMembership">
			<Relationship Name="Member">
				<Entry>
					<References Name="[trinity]" Disambiguator="5" />
				</Entry>
			</Relationship>
			<Relationship Name="Role">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[db_datareader]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlSchema" Name="[Control]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[Control].[DownloadQueue]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[DownloadQueue].[DownloadQueueID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[DownloadQueue].[RunID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[DownloadQueue].[FileID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[DownloadQueue].[StatusCode]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="8" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[DownloadQueue].[QueueDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="9" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[DownloadQueue].[DownloadDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="19" />
			<AttachedAnnotation Disambiguator="13" />
			<AttachedAnnotation Disambiguator="14" />
			<AttachedAnnotation Disambiguator="15" />
		</Element>
		<Element Type="SqlTable" Name="[Control].[Files]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Files].[FileID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Files].[SystemID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Files].[SourceURI]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Files].[FileName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Files].[DateOffset]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Files].[FileDesc]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Files].[TargetURI]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="20" />
			<AttachedAnnotation Disambiguator="16" />
		</Element>
		<Element Type="SqlProcedure" Name="[Control].[Get_FileDownloadMetadata]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	DECLARE @BusinessDate DATE;
	
	IF @RunID = 0 SELECT @RunID = MIN(RunID) FROM [Control].[DownloadQueue] WHERE StatusCode = 0;

	SELECT @BusinessDate = BusinessDate FROM [Control].[Run] WHERE RunID = @RunID;

-- This code isnt generic, will only work for AFR files.
-- Change when addition systems are added
	
	SELECT
		A.FileID,
		REPLACE(B.SourceURI,'[YYYY-MM-DD]',CONVERT(char(10),DATEADD(d,B.DateOffset,@BusinessDate),126)) AS [SourceURI],
		REPLACE(B.FileName,'[YYMMDD]',CONVERT(char(6),DATEADD(d,B.DateOffset,@BusinessDate),12)) AS [FileName],
		B.TargetURI,
		A.RunID
	FROM [Control].[DownloadQueue] AS A
	INNER JOIN [Control].[Files] AS B on A.FileID = B.FileID
	WHERE StatusCode = 0 -- Only files that are pending 
	AND RunID = @RunID;


END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Get_FileDownloadMetadata].[@RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[StatusCode]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run].[BusinessDate]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[SourceURI]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[char]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[DateOffset]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[FileName]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[char]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[TargetURI]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[StatusCode]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[RunID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Control].[Get_FileDownloadMetadata].[@RunID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="210" />
				<Property Name="Length" Value="1226" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- *********************************************&#xD;&#xA;-- Author:&#x9;&#x9;Aaron Jackson&#xD;&#xA;-- Create date: 05/04/2015&#xD;&#xA;-- Description:&#x9;Get a file to download from the queue&#xD;&#xA;-- *********************************************&#xD;&#xA;CREATE PROCEDURE [Control].[Get_FileDownloadMetadata]&#xD;&#xA;&#x9;@RunID INT = 0 --If not supplied, the min will be found&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Control].[Get_FileUploadMetadata]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	DECLARE @BusinessDate DATE, @RunID INT;
	
	SELECT @RunID = MIN(RunID) FROM [Control].[UploadQueue] WHERE StatusCode = 0 AND FileID = @FileID;

	SELECT @BusinessDate = BusinessDate FROM [Control].[Run] WHERE RunID = @RunID;

-- This code isnt generic, will only work for AFR files.
-- Change when addition systems are added
	
	SELECT
		A.RunID,
		B.SystemID,
		B.TargetURI AS [Directory],
		REPLACE(B.FileName,'[YYMMDD]',CONVERT(char(6),DATEADD(d,B.DateOffset,@BusinessDate),12)) AS [Filename]
	FROM [Control].[UploadQueue] AS A
	INNER JOIN [Control].[Files] AS B on A.FileID = B.FileID
	WHERE A.StatusCode = 0 -- Only files that are pending 
	AND A.RunID = @RunID
	AND A.FileID = @FileID;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[StatusCode]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Get_FileUploadMetadata].[@FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run].[BusinessDate]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[SystemID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[TargetURI]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[FileName]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[char]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Files].[DateOffset]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[StatusCode]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Control].[Get_FileUploadMetadata].[@FileID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="273" />
				<Property Name="Length" Value="1187" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- *********************************************&#xD;&#xA;-- Author:&#x9;&#x9;Aaron Jackson&#xD;&#xA;-- Create date: 07/04/2015&#xD;&#xA;-- Description:&#x9;Get RunID and Filename for a FileID&#xD;&#xA;-- Test: EXEC [Control].[Get_FileUploadMetadata] @FileID = 1;&#xD;&#xA;-- *********************************************&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [Control].[Get_FileUploadMetadata]&#xD;&#xA;&#x9;@FileID INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Control].[InitialiseAutomation]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	-- Populate run with business date
	EXEC [Control].[InitialiseRun];
	-- Populate Download Queue
	EXEC [Control].[InitialiseDownloadQueue];
	-- Populate Upload Queue
	EXEC [Control].[InitialiseUploadQueue];

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Control].[InitialiseRun]" />
				</Entry>
				<Entry>
					<References Name="[Control].[InitialiseDownloadQueue]" />
				</Entry>
				<Entry>
					<References Name="[Control].[InitialiseUploadQueue]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="190" />
				<Property Name="Length" Value="592" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;&#xD;&#xA;-- *********************************************&#xD;&#xA;-- Author:&#x9;&#x9;Aaron Jackson&#xD;&#xA;-- Create date: 05/04/2015&#xD;&#xA;-- Description:&#x9;Update status&#xD;&#xA;-- *********************************************&#xD;&#xA;CREATE PROCEDURE [Control].[InitialiseAutomation]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Control].[InitialiseDownloadQueue]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	-- SIMPLE HACK FOR NOW
	
	INSERT INTO [Control].[DownloadQueue] (RunID, FileID)
	SELECT 
		RunID,
		1
	FROM [Control].[Run]
	WHERE RunID NOT IN (SELECT RunID FROM [Control].[DownloadQueue]);
	
	
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[RunID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="190" />
				<Property Name="Length" Value="586" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;&#xD;&#xA;-- *********************************************&#xD;&#xA;-- Author:&#x9;&#x9;Aaron Jackson&#xD;&#xA;-- Create date: 05/04/2015&#xD;&#xA;-- Description:&#x9;Update status&#xD;&#xA;-- *********************************************&#xD;&#xA;CREATE PROCEDURE [Control].[InitialiseDownloadQueue]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Control].[InitialiseRun]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	
	DECLARE @EOD_D DATE = (SELECT CASE (DATEPART(dw, MAX(BusinessDate)) + @@DATEFIRST) % 7
										WHEN 1 THEN DATEADD(day,1,MAX(BusinessDate)) --'Sunday'
										WHEN 2 THEN DATEADD(day,1,MAX(BusinessDate)) --'Monday'
										WHEN 3 THEN DATEADD(day,1,MAX(BusinessDate)) --'Tuesday'
										WHEN 4 THEN DATEADD(day,1,MAX(BusinessDate)) --'Wednesday'
										WHEN 5 THEN DATEADD(day,1,MAX(BusinessDate)) --'Thursday'
										WHEN 6 THEN DATEADD(day,3,MAX(BusinessDate)) --'Friday'
										WHEN 0 THEN DATEADD(day,2,MAX(BusinessDate)) --'Saturday'
									END FROM [Control].[Run]);
	DECLARE @DATE_COUNT INT;
	DECLARE @MAX_DATE DATE = GETDATE();

	WHILE @EOD_D < @MAX_DATE
	BEGIN

		SELECT @DATE_COUNT = COUNT(*) FROM [PARM_Control].[Control].[Run] WHERE BusinessDate = @EOD_D;

		IF @DATE_COUNT = 0 -- if date doesnt already exist in table
		BEGIN
			INSERT INTO [PARM_Control].[Control].[Run] (BusinessDate)
			SELECT @EOD_D;
		END

		SELECT @EOD_D = -- get next date
			CASE (DATEPART(dw, @EOD_D) + @@DATEFIRST) % 7
				WHEN 1 THEN DATEADD(day,1,@EOD_D) --'Sunday'
				WHEN 2 THEN DATEADD(day,1,@EOD_D) --'Monday'
				WHEN 3 THEN DATEADD(day,1,@EOD_D) --'Tuesday'
				WHEN 4 THEN DATEADD(day,1,@EOD_D) --'Wednesday'
				WHEN 5 THEN DATEADD(day,1,@EOD_D) --'Thursday'
				WHEN 6 THEN DATEADD(day,3,@EOD_D) --'Friday'
				WHEN 0 THEN DATEADD(day,2,@EOD_D) --'Saturday'
			END
	END

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run].[BusinessDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry />
				<Entry />
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="190" />
				<Property Name="Length" Value="1802" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;&#xD;&#xA;-- *********************************************&#xD;&#xA;-- Author:&#x9;&#x9;Aaron Jackson&#xD;&#xA;-- Create date: 05/04/2015&#xD;&#xA;-- Description:&#x9;Update status&#xD;&#xA;-- *********************************************&#xD;&#xA;CREATE PROCEDURE [Control].[InitialiseRun]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Control].[InitialiseUploadQueue]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	INSERT INTO [Control].[UploadQueue] (RunID, FileID)
	SELECT 
		RunID,
		1
	FROM [Control].[Run]
	WHERE RunID NOT IN (SELECT RunID FROM [Control].[UploadQueue]);
	
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Run].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[RunID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="190" />
				<Property Name="Length" Value="549" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;&#xD;&#xA;-- *********************************************&#xD;&#xA;-- Author:&#x9;&#x9;Aaron Jackson&#xD;&#xA;-- Create date: 05/04/2015&#xD;&#xA;-- Description:&#x9;Update status&#xD;&#xA;-- *********************************************&#xD;&#xA;CREATE PROCEDURE [Control].[InitialiseUploadQueue]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Control].[ProcessLog]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[ProcessLog].[Temp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[Control].[QueueStatusCodes]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[QueueStatusCodes].[StatusCode]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[QueueStatusCodes].[StatusCodeDesc]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="22" />
		</Element>
		<Element Type="SqlTable" Name="[Control].[Run]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Run].[RunID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[Run].[BusinessDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="21" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="23" />
		</Element>
		<Element Type="SqlProcedure" Name="[Control].[Set_DownloadStatus]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	
	UPDATE [Control].[DownloadQueue]
	SET StatusCode = @StatusCode,
		DownloadDate = GETDATE()
	WHERE RunID = @RunID
	AND FileID = @FileID;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Control].[DownloadQueue]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[StatusCode]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Set_DownloadStatus].[@StatusCode]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[DownloadDate]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Set_DownloadStatus].[@RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[DownloadQueue].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Set_DownloadStatus].[@FileID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Control].[Set_DownloadStatus].[@RunID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Control].[Set_DownloadStatus].[@FileID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Control].[Set_DownloadStatus].[@StatusCode]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="188" />
				<Property Name="Length" Value="567" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- *********************************************&#xD;&#xA;-- Author:&#x9;&#x9;Aaron Jackson&#xD;&#xA;-- Create date: 05/04/2015&#xD;&#xA;-- Description:&#x9;Update status&#xD;&#xA;-- *********************************************&#xD;&#xA;CREATE PROCEDURE [Control].[Set_DownloadStatus]&#xD;&#xA;&#x9;@RunID INT,&#xD;&#xA;&#x9;@FileID INT,&#xD;&#xA;&#x9;@StatusCode INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Control].[Set_UploadStatus]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	
	UPDATE [Control].[UploadQueue]
	SET StatusCode = @StatusCode,
		UploadDate = GETDATE()
	WHERE RunID = @RunID
	AND FileID = @FileID;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Control].[UploadQueue]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[StatusCode]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Set_UploadStatus].[@StatusCode]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[UploadDate]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Set_UploadStatus].[@RunID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[UploadQueue].[FileID]" />
				</Entry>
				<Entry>
					<References Name="[Control].[Set_UploadStatus].[@FileID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Control].[Set_UploadStatus].[@RunID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Control].[Set_UploadStatus].[@FileID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Control].[Set_UploadStatus].[@StatusCode]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="188" />
				<Property Name="Length" Value="561" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- *********************************************&#xD;&#xA;-- Author:&#x9;&#x9;Aaron Jackson&#xD;&#xA;-- Create date: 05/04/2015&#xD;&#xA;-- Description:&#x9;Update status&#xD;&#xA;-- *********************************************&#xD;&#xA;CREATE PROCEDURE [Control].[Set_UploadStatus]&#xD;&#xA;&#x9;@RunID INT,&#xD;&#xA;&#x9;@FileID INT,&#xD;&#xA;&#x9;@StatusCode INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Control].[SourceSystems]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[SourceSystems].[SystemID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[SourceSystems].[SystemName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[SourceSystems].[SystemDesc]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="17" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Control].[UNQ_BusinessDate]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Control].[Run].[BusinessDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Control].[Run]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="23" />
		</Element>
		<Element Type="SqlTable" Name="[Control].[UploadQueue]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[UploadQueue].[UploadQueueID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[UploadQueue].[RunID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[UploadQueue].[FileID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[UploadQueue].[StatusCode]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="6" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[UploadQueue].[QueueDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="7" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Control].[UploadQueue].[UploadDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Control]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="18" />
			<AttachedAnnotation Disambiguator="10" />
			<AttachedAnnotation Disambiguator="11" />
			<AttachedAnnotation Disambiguator="12" />
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Connect.Database].[trinity].[dbo]">
			<Property Name="Permission" Value="1035" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[trinity]" Disambiguator="5" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Disambiguator="1" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlLogin" Name="[trinity]">
			<Property Name="Password" Value="eivctwasn3mMmkwrxo|ZuoacmsFT7_&amp;#$!~&lt;qduadh||Zqze" />
			<Property Name="DefaultLanguage" Value="us_english" />
			<Property Name="Sid" Value="0x7BE2402C8006ED488AD776E4300963A4" />
			<Property Name="IsCheckPolicyOn" Value="False" />
			<Annotation Type="GloballyScoped" />
		</Element>
		<Element Type="SqlUser" Name="[trinity]" Disambiguator="5">
			<Property Name="LoginIdentifierScript">
				<Value><![CDATA[[trinity]]]></Value>
			</Property>
			<Relationship Name="Login">
				<Entry>
					<References Name="[trinity]" />
				</Entry>
			</Relationship>
		</Element>
	</Model>
</DataSchemaModel>